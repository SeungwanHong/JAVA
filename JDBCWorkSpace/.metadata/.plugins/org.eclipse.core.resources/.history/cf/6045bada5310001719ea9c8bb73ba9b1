package testBoard.interDB.impl;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.SQLException;

public class DBConnector {
	final String DB_url = "jdbc:oracle:thin:@localhost:1521:orcl";
	final String DB_user = "hsw";
	final String DB_password = "hsw";
	
	Connection conn = null;							
	PreparedStatement pstmt = null;
	
	try{
		Class.forName("oracle.jdbc.driver.OracleDriver");
		System.out.println("라이브러리 로드 완료");

		//연결정보를 가지고 실제 데이터베이스에 접속
		//연결정보 및 쿼리 실행을 알 수 있는 Connetion 인터페이스의 구현 객체가 리턴된다.
		conn = DriverManager.getConnection(DB_url,DB_user,DB_password);
		System.out.println("접속 성공");

		String sql ="SELECT * FROM EMP";			//sql 문장(쿼리부분)
		pstmt = conn.prepareStatement(sql);		//preparedStatement에 쿼리 등록

		//rs = pstmt.executeQuery();						//쿼리 실행 후 resultSet 형태로 리턴

		//resultSet에 들어있는 쿼리 실행결과를 컬럼명을 이용하여 데이터 빼내기
		//re.next()가 작동 할 때마다 Cusor가 움지이다가 더이상 빼내올 데이터가 없으면 false리턴
		pstmt.close();
		conn.close();
	}catch(ClassNotFoundException e){
		e.printStackTrace();
		System.out.println("라이브러리 로드 실패");
	}catch(SQLException e){
		e.printStackTrace();
		System.out.println("접속 실패");
	}
	
}
